{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst DependencyReference = require(\"./DependencyReference\");\nconst HarmonyImportDependency = require(\"./HarmonyImportDependency\");\nconst HarmonyLinkingError = require(\"../HarmonyLinkingError\");\nclass HarmonyImportSpecifierDependency extends HarmonyImportDependency {\n  constructor(request, originModule, sourceOrder, parserScope, id, name, range, strictExportPresence) {\n    super(request, originModule, sourceOrder, parserScope);\n    this.id = id === null ? null : `${id}`;\n    this.redirectedId = undefined;\n    this.name = name;\n    this.range = range;\n    this.strictExportPresence = strictExportPresence;\n    this.namespaceObjectAsContext = false;\n    this.callArgs = undefined;\n    this.call = undefined;\n    this.directImport = undefined;\n    this.shorthand = undefined;\n  }\n  get type() {\n    return \"harmony import specifier\";\n  }\n  get _id() {\n    return this.redirectedId || this.id;\n  }\n  getReference() {\n    if (!this._module) return null;\n    return new DependencyReference(this._module, this._id && !this.namespaceObjectAsContext ? [this._id] : true, false, this.sourceOrder);\n  }\n  getWarnings() {\n    if (this.strictExportPresence || this.originModule.buildMeta.strictHarmonyModule) {\n      return [];\n    }\n    return this._getErrors();\n  }\n  getErrors() {\n    if (this.strictExportPresence || this.originModule.buildMeta.strictHarmonyModule) {\n      return this._getErrors();\n    }\n    return [];\n  }\n  _getErrors() {\n    const importedModule = this._module;\n    if (!importedModule) {\n      return;\n    }\n    if (!importedModule.buildMeta || !importedModule.buildMeta.exportsType) {\n      // It's not an harmony module\n      if (this.originModule.buildMeta.strictHarmonyModule && this._id !== \"default\") {\n        // In strict harmony modules we only support the default export\n        const exportName = this._id ? `the named export '${this._id}'` : \"the namespace object\";\n        return [new HarmonyLinkingError(`Can't import ${exportName} from non EcmaScript module (only default export is available)`)];\n      }\n      return;\n    }\n    if (!this._id) {\n      return;\n    }\n    if (importedModule.isProvided(this._id) !== false) {\n      // It's provided or we are not sure\n      return;\n    }\n\n    // We are sure that it's not provided\n    const idIsNotNameMessage = this._id !== this.name ? ` (imported as '${this.name}')` : \"\";\n    const errorMessage = `\"export '${this._id}'${idIsNotNameMessage} was not found in '${this.userRequest}'`;\n    return [new HarmonyLinkingError(errorMessage)];\n  }\n\n  // implement this method to allow the occurrence order plugin to count correctly\n  getNumberOfIdOccurrences() {\n    return 0;\n  }\n  updateHash(hash) {\n    super.updateHash(hash);\n    const importedModule = this._module;\n    hash.update((importedModule && this._id) + \"\");\n    hash.update((importedModule && this._id && importedModule.isUsed(this._id)) + \"\");\n    hash.update((importedModule && (!importedModule.buildMeta || importedModule.buildMeta.exportsType)) + \"\");\n    hash.update((importedModule && importedModule.used + JSON.stringify(importedModule.usedExports)) + \"\");\n  }\n  disconnect() {\n    super.disconnect();\n    this.redirectedId = undefined;\n  }\n}\nHarmonyImportSpecifierDependency.Template = class HarmonyImportSpecifierDependencyTemplate extends HarmonyImportDependency.Template {\n  apply(dep, source, runtime) {\n    super.apply(dep, source, runtime);\n    const content = this.getContent(dep, runtime);\n    source.replace(dep.range[0], dep.range[1] - 1, content);\n  }\n  getContent(dep, runtime) {\n    const exportExpr = runtime.exportFromImport({\n      module: dep._module,\n      request: dep.request,\n      exportName: dep._id,\n      originModule: dep.originModule,\n      asiSafe: dep.shorthand,\n      isCall: dep.call,\n      callContext: !dep.directImport,\n      importVar: dep.getImportVar()\n    });\n    return dep.shorthand ? `${dep.name}: ${exportExpr}` : exportExpr;\n  }\n};\nmodule.exports = HarmonyImportSpecifierDependency;","map":null,"metadata":{},"sourceType":"script"}