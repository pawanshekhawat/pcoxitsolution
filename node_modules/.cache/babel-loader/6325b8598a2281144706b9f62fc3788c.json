{"ast":null,"code":"'use strict';\n\nconst BB = require('bluebird');\nconst figgyPudding = require('figgy-pudding');\nconst fixOwner = require('./fix-owner');\nconst path = require('path');\nconst rimraf = BB.promisify(require('rimraf'));\nconst uniqueFilename = require('unique-filename');\nconst TmpOpts = figgyPudding({\n  tmpPrefix: {}\n});\nmodule.exports.mkdir = mktmpdir;\nfunction mktmpdir(cache, opts) {\n  opts = TmpOpts(opts);\n  const tmpTarget = uniqueFilename(path.join(cache, 'tmp'), opts.tmpPrefix);\n  return fixOwner.mkdirfix(cache, tmpTarget).then(() => {\n    return tmpTarget;\n  });\n}\nmodule.exports.withTmp = withTmp;\nfunction withTmp(cache, opts, cb) {\n  if (!cb) {\n    cb = opts;\n    opts = null;\n  }\n  opts = TmpOpts(opts);\n  return BB.using(mktmpdir(cache, opts).disposer(rimraf), cb);\n}\nmodule.exports.fix = fixtmpdir;\nfunction fixtmpdir(cache) {\n  return fixOwner(cache, path.join(cache, 'tmp'));\n}","map":null,"metadata":{},"sourceType":"script"}